<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Sting-Sense: Bus Analytics with Inertial Sensors</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="I like to write, design, code, and share some of the cool projects I'm working on. I try not to be boring.">
    <link rel="canonical" href="https://www.kausarpatherya.com/2024/12/13/mci-bus-analytics/">
    <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Kausar Patherya posts" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-3698471-23', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- KaTeX script -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
          ]
        });
      });
    </script>

</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <div style="float:left; margin-top:10px; margin-right:10px;">
    <a href="/feed.xml">
      <img src="/assets/rssicon.svg" width="40">
    </a>
    </div>

    <a class="site-title" href="/">Kausar Patherya</a>
    
    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
          
        
          
        
          
        
          <a class="page-link" href="/about/">About</a>
        
          
        
          
        
      </div>
    </nav>
  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Sting-Sense: Bus Analytics with Inertial Sensors</h1>
    <p class="meta">Dec 13, 2024</p>
  </header>

  <article class="post-content">
  <p>Ever missed a bus on campus and wondered why traffic seems to flow so unpredictably? Or driven over a bumpy road and thought, “Someone should fix this!” At Georgia Tech, the Sting-Sense project is trying to tackle these issues, paving the way for smarter transportation solutions.</p>

<p><strong>The challenge: traffic and maintenance on a busy campus</strong>. Urban campus transportation systems face numerous challenges, including traffic congestion and road maintenance. The Sting-Sense project addresses these issues by implementing an IoT system on GT’s bus network. This system provides visibility into bus behavior across different times of the day, enabling data-driven decision making.</p>

<iframe src="https://kpath1999.github.io/gtbusmap" width="100%" height="600px" style="border:none;"></iframe>

<p><strong>Hardware setup: compact yet powerful</strong>. The Sting-Sense system consists of a custom-built hardware package featuring a microcontroller, a GPS module, and an inertial measurement unit (IMU) sensor. These devices were installed on buses serving four major routes: gold, green, blue, and red. The gold route, in particular, is a vital link between Georgia Tech’s central campus, Tech Square, and the Midtown MARTA Station.<sup>1</sup></p>

<div style="text-align: center;">
    <img src="/assets/mci/hardware-setup.png" width="70%" />
    <em><br />Fig. 1. <b>Hardware Setup:</b> Compact and efficient, designed to fit seamlessly into the campus bus fleet.</em>
</div>

<p><strong>Data collection: metrics that matter</strong>. To analyze bus behavior and road quality, the Sting-Sense system collects data on three key metrics:</p>

<ol>
  <li>Timing: Precise timestamps record the exact moment each data point is logged, enabling temporal analysis of traffic patterns.</li>
  <li>Location: GPS tracks the real-time movement of buses, providing insights into route efficiency and congestion hotspots.</li>
  <li>Movement: IMU sensors capture acceleration and orientation, crucial for detecting road anomalies and assessing driver performance.</li>
</ol>

<p>The hardware setup took some time to build out, so we used the Sensor Logger app on an iPhone for the initial mapping of bus routes. It offers a range of sensors, including an accelerometer, gyroscope, GPS, barometer, and more. You can easily export all the data to a CSV for further processing.</p>

<div style="text-align: center;">
    <img src="/assets/mci/sensor-logger.png" width="20%" /> 
    <em><br />Fig. 2. <b>Early Data Collection:</b> The Sensor Logger app provided a user-friendly interface for capturing multi-sensor data during the project's pilot phase.</em>
</div>

<p><strong>Traffic congestion analysis</strong>. We use GPS data to understand traffic patterns. Speed data from the GPS is grouped into four congestion levels (quartiles). This method helps us discern traffic patterns across the day and in different parts of campus. The slowest speeds (1st quartile) indicate high congestion.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">calculate_traffic_congestion</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">speed_stats</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">speed</span><span class="sh">'</span><span class="p">].</span><span class="nf">describe</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">calculate_congestion_level</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="sh">'</span><span class="s">speed</span><span class="sh">'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">speed</span> <span class="o">&lt;=</span> <span class="n">speed_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">25%</span><span class="sh">'</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">5</span>  <span class="c1"># Heavy congestion
</span>        <span class="k">elif</span> <span class="n">speed</span> <span class="o">&lt;=</span> <span class="n">speed_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">50%</span><span class="sh">'</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">4</span>  <span class="c1"># Moderate-heavy congestion
</span>        <span class="k">elif</span> <span class="n">speed</span> <span class="o">&lt;=</span> <span class="n">speed_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">mean</span><span class="sh">'</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">3</span>  <span class="c1"># Moderate congestion
</span>        <span class="k">elif</span> <span class="n">speed</span> <span class="o">&lt;=</span> <span class="n">speed_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">75%</span><span class="sh">'</span><span class="p">]:</span>
            <span class="k">return</span> <span class="mi">2</span>  <span class="c1"># Light congestion
</span>        <span class="k">elif</span> <span class="n">speed</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># Unavailable data
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>  <span class="c1"># No congestion
</span>
    <span class="c1"># Apply the function to each speed value
</span>    <span class="k">return</span> <span class="n">df</span><span class="p">.</span><span class="nf">apply</span><span class="p">(</span><span class="n">calculate_congestion_level</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Road quality assessment</strong>. Vertical acceleration data is used to assess road quality. A measure is created called Standard Deviation of Vertical Acceleration (SDVA). SDVA is calculated by dividing the variation in vertical movement by the average speed. This helps detect bumps or issues in the road.</p>

<p>$$\ \text{SDVA} = \frac{\sigma(a_z)}{\bar{v}} $$ where $\sigma(a_z)$ is the standard deviation of vertical acceleration and $\bar{v}$ is the average speed over a segment. To focus on bumps and ignore small vibrations, the Butterworth low-pass filter is used. Thresholds are based on real-world data to classify road conditions into four categories.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">calculate_road_condition</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    
    <span class="c1"># Apply low-pass filter to vertical acceleration
</span>    <span class="n">sampling_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">seconds_elapsed</span><span class="sh">'</span><span class="p">].</span><span class="nf">diff</span><span class="p">().</span><span class="nf">mean</span><span class="p">()</span>
    <span class="n">cutoff_frequency</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Hz
</span>    <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">z_filtered</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="nf">butter_lowpass_filter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">z</span><span class="sh">'</span><span class="p">],</span> <span class="n">cutoff_frequency</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="c1"># Calculate SDVA (Standard Deviation of Vertical Acceleration)
</span>    <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">sdva</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">z_filtered</span><span class="sh">'</span><span class="p">].</span><span class="nf">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window_size</span><span class="p">).</span><span class="nf">std</span><span class="p">()</span>

    <span class="c1"># Normalize SDVA by speed (to account for speed effects)
</span>    <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">sdva_normalized</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">sdva</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">speed</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Adding 1 to avoid division by zero
</span>
    <span class="c1"># Define thresholds for road condition classification
</span>    <span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">sdva_normalized</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">),</span>
        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">sdva_normalized</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">sdva_normalized</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.15</span><span class="p">),</span>
        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">sdva_normalized</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">),</span>
        <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">sdva_normalized</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Create road_condition column
</span>    <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">road_condition</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">select</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></div>

<h3 id="future-improvements">Future Improvements</h3>

<p>To maximize the impact of Sting-Sense, we plan to upgrade the system with cellular network connectivity. This will allow for real-time data uploads to the cloud, making information instantly accessible for analysis and decision-making.</p>

<p>Our big goal is to build a system that can work on its own. This means processing data as soon as it’s collected and making decisions without human help. The implementation of predictive maintenance strategies in IoT systems in transportation brings several benefits.</p>

<ul>
  <li>It allows for a shift from reactive to proactive maintenance, minimizing unplanned downtime and disruptions in transportation services.</li>
  <li>By addressing maintenance needs before failures occur, organizations can improve the reliability and availability of vehicles and infrastructure, enhancing passenger safety and customer satisfaction.</li>
</ul>

<p><strong>Conclusion</strong>. This pilot project can be improved further by adding more bus routes and including other campus vehicles. We could make this system even more useful by using machine learning to predict when buses need maintenance and finding better routes for buses. If we link Sting-Sense with other campus information like class schedules and event calendars, we could make the bus service respond better to campus needs.<sup>2</sup></p>

<p><strong>What’s next?</strong> As we continue to improve Sting-Sense, Georgia Tech could set new standards for smart campus transportation and become a model for other schools and cities to follow. The project aligns with Georgia Tech’s goal to have 100% clean transportation by 2030. By leveraging IoT technologies, we can optimize route planning, enhance passenger experiences, monitor vehicle health in real-time, improve safety, and enable demand-responsive transit services.<sup>3</sup></p>

  </article>

  <!-- mathjax -->
  
  
  <!-- disqus comments -->
 
  
</div>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <!-- <h2 class="footer-heading">Kausar Patherya</h2> -->

    <div class="footer-col-1 column">
      <ul>
        <li>Kausar Patherya</li>
        <!-- <li><a href="mailto:"></a></li> -->
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/kpath1999">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">kpath1999</span>
          </a>
        </li>
        
        
        <li>
          <a href="https://linkedin.com/in/k-path">
            <span class="icon linkedin">
              <svg style="filter: grayscale(50%);" class="linkedin-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="#0A66C2">
                <rect width="24" height="24" fill="#D3D3D3"/>
                <path d="M20.45,20.45H17.1v-5.21c0-1.25-0.02-2.85-1.74-2.85c-1.74,0-2.01,1.36-2.01,2.76v5.3h-3.35V9.5h3.22v1.47h0.04 c0.45-0.85,1.54-1.74,3.18-1.74c3.4,0,4.03,2.24,4.03,5.15L20.45,20.45L20.45,20.45z M5.95,8.03c-1.08,0-1.95-0.88-1.95-1.95 c0-1.08,0.87-1.95,1.95-1.95c1.07,0,1.95,0.87,1.95,1.95C7.9,7.15,7.02,8.03,5.95,8.03z M7.63,20.45H4.27V9.5h3.36V20.45z" fill="#FFFFFF"/>
              </svg>
            </span>
            <span class="username">k-path</span>
          </a>
        </li>
        
        
          
      </ul>
    </div>

    <div class="footer-col-3 column">
      <p class="text">I like to write, design, code, and share some of the cool projects I'm working on. I try not to be boring.</p>
    </div>

  </div>

</footer>

    </body>
</html>